var t=require("url");function a(a){var e=t.parse(a,!0);return delete e.search,e}var e=function(e){"undefined"==typeof document||location;e=t.resolve("https://",e),this.a=a(e),this.mode=e.match(/@base/)?"kingsoft":/app\/shop\/img\?/.test(e)?"standard":"unkown"},r={url:{configurable:!0}};r.url.get=function(){return t.format(this.a)},r.url.set=function(t){console.warn("u can't set its url")},e.prototype.setWebp=function(){switch(this.mode){case"standard":this.standardAddParam("t","webp");break;case"kingsoft":this.kingsoftAddParam("F","webp")}return this},e.prototype.resize=function(t){var a=t.w,e=t.h;switch(this.mode){case"standard":this.standardAddParams({w:a,h:e});break;case"kingsoft":var r={w:this.kingsoftGetParam("w"),h:this.kingsoftGetParam("h")};if(r.w&&r.h){var s=a/this.kingsoftGetParam("etw")||1,n=e/this.kingsoftGetParam("eth")||1;this.kingsoftAddParams({w:Math.round(s*r.w),h:Math.round(n*r.h)})}this.kingsoftAddParams({etw:a,eth:e})}return this},e.prototype.getSize=function(){return"standard"===this.mode?{w:this.standardGetParam("w"),h:this.standardGetParam("h")}:"kingsoft"===this.mode?{w:this.kingsoftGetParam("etw"),h:this.kingsoftGetParam("eth")}:void 0},e.prototype.standardGetParam=function(t){return this.a.query[t]},e.prototype.kingsoftGetParam=function(t){return(this.a.pathname.match(new RegExp("[?|&]"+t+"=(\\d+)"))||[])[1]},e.prototype.standardAddParams=function(t){Object.assign(this.a.query,t)},e.prototype.standardAddParam=function(t,a){this.a.query[t]=a},e.prototype.kingsoftAddParams=function(t){this.kingsoftAddParam(void 0,void 0,t)},e.prototype.kingsoftAddParam=function(e,r,s){var n,i=(this.a.pathname.match(/@[\s\S]+?(&|$)/,"?")||[""])[0],o=this.a.pathname;i&&(o=o.replace(i,"?"));var d=s||((n={})[e]=r,n),h=a(o);Object.assign(h.query,d),o=t.format(h),i&&(o=o.replace("?",i)),this.a.pathname=o},Object.defineProperties(e.prototype,r),module.exports=e;
//# sourceMappingURL=youpin-img.js.map
